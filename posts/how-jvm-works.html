<!DOCTYPE html><html lang="ko-KR"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><meta property="og:url" content="https://100paperkite.github.io"/><meta property="og:type" content="website"/><meta property="og:locale" content="ko-KR"/><meta property="og:site_name" content="paperkite.log 👋"/><title>JVM(Java Virtual Machine) | paperkite.log 👋</title><meta name="robots" content="index,follow"/><meta name="description" content="JVM(Java Virtual Machine)"/><meta property="og:title" content="JVM(Java Virtual Machine) | paperkite.log 👋"/><meta property="og:description" content="JVM(Java Virtual Machine)"/><script type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","datePublished":"2023-01-08","description":"JVM(Java Virtual Machine)","mainEntityOfPage":{"@type":"WebPage","@id":"https://100paperkite.github.io/posts/how-jvm-works"},"headline":"JVM(Java Virtual Machine)","dateModified":"2023-01-08","author":{"@type":"Person","name":"100paperkite"}}</script><meta name="next-head-count" content="12"/><script id="gtag-init" strategy="afterInteractive">
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'G-FFSLQ27YMJ', {
                page_path: window.location.pathname,
              });
            </script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-FFSLQ27YMJ"></script><link rel="preload" href="/_next/static/css/5b02753c16e8292d.css" as="style"/><link rel="stylesheet" href="/_next/static/css/5b02753c16e8292d.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-7899d29197c80e1a.js" defer=""></script><script src="/_next/static/chunks/framework-a070cbfff3c750c5.js" defer=""></script><script src="/_next/static/chunks/main-1b1db7be3343898e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-c1e739f18573092f.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-6dd5619a8decfbcd.js" defer=""></script><script src="/_next/static/chunks/0c428ae2-aee1a03cbb0f41ac.js" defer=""></script><script src="/_next/static/chunks/17007de1-711cf284c97b49d4.js" defer=""></script><script src="/_next/static/chunks/5386-fe879e79d19b629e.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bslug%5D-eede4a858aac6600.js" defer=""></script><script src="/_next/static/uL8yKBX6xBidVOUOOPHk3/_buildManifest.js" defer=""></script><script src="/_next/static/uL8yKBX6xBidVOUOOPHk3/_ssgManifest.js" defer=""></script><script src="/_next/static/uL8yKBX6xBidVOUOOPHk3/_middlewareManifest.js" defer=""></script></head><body><div id="__next" data-reactroot=""><div class="flex flex-col min-h-screen"><nav class="flex justify-between sticky top-0 z-50 space-x-4 py-2 font-medium mx-2 md:mx-6 my-1 md:my-2 p-2"><a class="text-neutral-800 hover:text-neutral-600 text-lg md:text-xl" href="/">paperkite.log 👋</a><div class="flex gap-x-3"><a href="/tags"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 640 512" class="hover:cursor-pointer w-6 h-6 text-neutral-700" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"></path></svg></a></div></nav><main class="max-w-screen-md px-4 w-full mx-auto flex-grow font-body"><div class="px-2 md:px-4 py-2 md:py-4"><div class="border-b border-1 mb-4 sm:mb-6 border-dashed border-neutral-300"><div class="flex items-center my-1 md:my-2 gap-x-2"><button class="text-neutral-500 font-bold">#java</button><button class="text-neutral-500 font-bold">#jvm</button></div><h1 class="text-3xl sm:text-4xl font-bold mb-2 sm:mb-4 mt-6 sm:mt-10">JVM(Java Virtual Machine)</h1><div class="flex py-2 md:py-3 pl-1 text-neutral-500"><small class="">January 8, 2023<!-- -->에 작성</small></div></div><article class="max-w-none prose prose-neutral prose-sm sm:prose-base md:prose-md"><h2>가상 머신(Virtual Machine)</h2>
<p>안에서 돌아가는 소프트웨어가 가상머신이 제공하는 환경과 자원에 제한을 받으며 가상 환경을 벗어날 수 없다.</p>
<ul>
<li>System Virtual Machine<!-- -->
<ul>
<li>완전한 OS 실행을 지원.</li>
<li>같은 컴퓨터 내에서 여러 운영체제를 돌릴 수 있다.</li>
</ul>
</li>
<li>Process Virtual Machine<!-- -->
<ul>
<li>단일 프로세스를 지원</li>
<li>플랫폼에 독립적인 실행환경과 추상화를 제공하여 하나의 프로그램을 실행한다.</li>
<li>JVM이 이런 경우다. (C#의 CLR도 마찬가지)</li>
</ul>
</li>
</ul>
<h2>JVM?</h2>
<p>JVM은 명세이다. 이 명세를 따른 구현체들이 따로 존재한다. (HotSpot VM 등등)</p>
<h2>JVM Architecture</h2>
<p>Java로 작성된 코드는 Compiler가 바이트 코드(.class 파일) 로 변환하고, JRE에 속한 JVM이 이 바이트 코드를 JIT 컴파일하여 실행된다.</p>
<ul>
<li>JDK (Java Development Kit)<!-- -->
<ul>
<li>JRE를 포함하며, 개발을 위한 컴파일러나 디버거도 같이 제공된다.</li>
</ul>
</li>
<li>JRE (Java Runtime Environment)</li>
</ul>
<h2>구성 요소</h2>
<div class="text-center pt-1 sm:pt-2 md:pt-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27700%27%20height=%27360%27/%3e"/></span><img alt="jvm architecture" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="max-w-full h-auto" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="jvm architecture" src="/jvm-architecture.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="max-w-full h-auto" loading="lazy"/></noscript></span><a class=" text-xs underline text-neutral-500" href="https://www.freecodecamp.org">https://www.freecodecamp.org</a></div>
<h2>Class Loader</h2>
<div class="text-center pt-1 sm:pt-2 md:pt-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27700%27%20height=%27300%27/%3e"/></span><img alt="jvm class loader" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="max-w-full h-auto" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="jvm class loader" src="/jvm-class-loader.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="max-w-full h-auto" loading="lazy"/></noscript></span><a class=" text-xs underline text-neutral-500" href="https://www.freecodecamp.org">https://www.freecodecamp.org</a></div>
<h3>Loading</h3>
<h4>1. 클래스 정보를 읽어온다.</h4>
<ul>
<li>‘.class’ 파일을 읽으면, 관련된 바이너리 데이터를 생성하고 이를 method area에 저장한다.</li>
<li>method area에 저장되는 정보들은 다음과 같다<!-- -->
<ul>
<li>패키지 명이 전부 포함된 클래스 경로(Fully Qualified Name), 해당 클래스의 부모 클래스</li>
<li>‘.class’파일이 Class인지, Interface인지 Enum인지 여부</li>
<li>접근 한정자(private, public …)와 메서드 정보 등</li>
</ul>
</li>
</ul>
<p>JVM이 클래스를 불러올 때 사용하는 3가지 로더는 다음과 같다.</p>
<ol>
<li>Bootstrap ClassLoader<!-- -->
<ul>
<li>최상위 ClassLoader이다. 이 로더가 JAR파일이나<code> $JAVA_HOME/jre/lib</code> 경로의 코어 라이브러리에서 패키지를 불러온다.</li>
</ul>
</li>
<li>Extension ClassLoader<!-- -->
<ul>
<li>Bootstrap 클래스 로더의 하위 클래스이고, Application ClassLoader의 상위 클래스이다.</li>
<li><code>$JAVA_HOME/jre/lib/ext</code> 경로에서 패키지 파일을 불러온다.</li>
</ul>
</li>
<li>Application ClassLoader<!-- -->
<ul>
<li>이 클래스로더는 classpath의 파일들을 불러온다. (기본 경로값은 현재 어플리케이션 디렉토리)</li>
<li>클래스를 못 찾으면 <code>ClassNotFoundError</code>를 던진다.</li>
</ul>
</li>
</ol>
<h4>2. 정보를 읽어온 후엔 클래스 타입의 오브젝트를 생성한다.</h4>
<ul>
<li>JVM이 클래스를 처음 로딩해오면 JVM은 <code>java.lang</code> 패키지에 정의된 <code>Class</code> 클래스에서 오브젝트를 생성한다.</li>
<li>이 클래스 오브젝트는 프로그래머가 클래스들의 정보(클래스명, 부모 클래스명, 메서드나 변수 정보 등)를 얻기 위해 사용할 수 있다.</li>
<li>클래스마다 하나의 오브젝트만 존재하도록 관리된다.</li>
<li>그리고 이 ‘Class’타입 오브젝트는 힙에 저장된다.</li>
</ul>
<h3>Linking</h3>
<h4>1. Verification</h4>
<ul>
<li>.class파일을 로딩해올 때, bytecode verifier라는 프로그램이 .class파일을 검증한다.<!-- -->
<ul>
<li>유효한 컴파일러로 컴파일 된 것인지.</li>
<li>올바른 구조, 포맷인지.</li>
</ul>
</li>
<li>verification중 하나라도 실패하면 JVM은 verifier exception 에러를 런타임에 던진다.</li>
</ul>
<h4>2. Preparation</h4>
<ul>
<li>만약 클래스가 instance level이거나 static 변수를 가지고 있으면 기본값으로 초기화 시킨다. (설정해둔 초기값이 아님)</li>
<li>ex. boolean → false, int → 0, 이런 식.</li>
</ul>
<h4>3. Resolution</h4>
<ul>
<li>참조 변수들을 실제 메모리 주소값으로 변경한다.</li>
</ul>
<h3>Initialization</h3>
<p>코드로 설정한 초기값들이 여기서 할당된다. 그리고 클래스의 정적 영역들이 실행된다.</p>
<h2>Memory Area (= Runtime Data Area)</h2>
<div class="text-center pt-1 sm:pt-2 md:pt-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27700%27%20height=%27240%27/%3e"/></span><img alt="jvm runtime data" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="max-w-full h-auto" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="jvm runtime data" src="/jvm-runtime-data.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="max-w-full h-auto" loading="lazy"/></noscript></span><a class=" text-xs underline text-neutral-500" href="https://www.freecodecamp.org">https://www.freecodecamp.org</a></div>
<ul>
<li><strong>Method Area</strong>
<ul>
<li>모든 클래스 정보. (method data, constructor details …)</li>
<li>JVM마다 하나가 존재하며, 다른 스레드들과 공유되는 공간이다.</li>
</ul>
</li>
<li><strong>Heap</strong>
<ul>
<li>모든 오브젝트, static 변수(JAVA 8부터 적용)</li>
<li>JVM마다 하나가 존재하며, 다른 스레드들과 공유되는 공간이다.</li>
</ul>
</li>
<li><strong>Stack</strong>
<ul>
<li>함수 호출마다 쌓임. 로컬 변수들이 저장된다.</li>
<li>각 스레드마다 존재하며, 스레드가 종료되면 해당 영역도 제거된다.</li>
</ul>
</li>
<li><strong>PC Register</strong>
<ul>
<li>각 스레드마다 존재하며, 현재 실행중인 명령어 위치를 저장한다.</li>
</ul>
</li>
<li><strong>Native Method Stack</strong>
<ul>
<li>각 스레드마다 존재하며, native methods 정보를 저장한다.</li>
</ul>
</li>
</ul>
<h2>Execution Engine</h2>
<div class="text-center pt-1 sm:pt-2 md:pt-3"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27700%27%20height=%27250%27/%3e"/></span><img alt="jvm execution engine" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="max-w-full h-auto" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="jvm execution engine" src="/jvm-execution-engine.png" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="max-w-full h-auto" loading="lazy"/></noscript></span><a class=" text-xs underline text-neutral-500" href="https://www.freecodecamp.org">https://www.freecodecamp.org</a></div>
<p><code>.class</code> 코드(bytecode)를 실행한다.</p>
<h3>Interpreter</h3>
<ul>
<li>bytecode를 읽으면서 machine code로 변환한다.</li>
</ul>
<h3>JIT compiler</h3>
<ul>
<li>JVM은 처음엔 인터프리터를 쓰지만, 해석해야 할 bytecode가 반복적이면, JVM은 JIT를 대신 사용해서 전체 코드를 machine code로 컴파일한다. (매번 같은 코드에 대해 인터프리터를 사용하는 것 보다 한번에 컴파일해서 최적화 하는게 더 빠르기 때문)</li>
<li>JIT compiler는 다음과 같은 4가지로 이루어져 있다<!-- -->
<ul>
<li>Intermediate Code Generator - 중간 코드 생성</li>
<li>Code Optimizer - 코드 최적화</li>
<li>Target Code Generator - 머신 코드 생성</li>
<li>Profiler - 최적화를 위해 반복되는 코드를 찾음(hotspot)</li>
</ul>
</li>
</ul>
<h3>GC(Garbage Collector)</h3>
<ul>
<li>C 같은 언어들은 프로그래머가 직접 메모리를 할당/해제 해야 하지만 Java는 JVM이 알아서 처리해준다.</li>
<li>GC는 백그라운드로 실행되면서 주기적으로, 더 이상의 참조가 없는 Heap 상의 오브젝트들을 해제한다.<!-- -->
<ul>
<li>Mark → 메모리에서 더 이상 쓰지 않는 오브젝트들을 마킹.</li>
<li>Sweep → 마킹된 오브젝트들을 해제.</li>
</ul>
</li>
<li>GC 방법엔 여러가지가 있다.<!-- -->
<ul>
<li>Serial GC → 싱글스레드 환경으로 돌아감. GC가 동작하면 어플리케이션이 멎어버림.</li>
<li>Parallel GC → 멀티 스레드를 이용. (하지만 여전히 어플리케이션이 멎을 때가 있음)</li>
<li>G1GC</li>
</ul>
</li>
</ul>
<h3>JNI interface</h3>
<p>JVM에서 실행하는 자바 코드가 네이티브 응용 프로그램이나 다른 언어로 작성된 라이브러리를 호출/호출되는 것을 가능하게 하는 프레임워크. .dll 또는 .so 포맷.</p>
<h2>참고</h2>
<ul>
<li>
<p><a href="https://hasithas.medium.com/understanding-how-java-virtual-machine-jvm-works-a1b07c0c399a">https://hasithas.medium.com/understanding-how-java-virtual-machine-jvm-works-a1b07c0c399a</a></p>
</li>
<li>
<p><a href="https://www.geeksforgeeks.org/jvm-works-jvm-architecture/">https://www.geeksforgeeks.org/jvm-works-jvm-architecture/</a></p>
</li>
</ul></article><div><hr class="border-t border-neutral-300 my-8 sm:my-16"/><section></section></div></div></main><footer class="font-title py-4 sm:py-8 flex flex-col items-center text-neutral-600"><div class="flex flex-row my-2"><div class="flex items-center py-1"><a class="m-2 " href="https://github.com/100paperkite"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="w-7 h-7" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M7.976 0A7.977 7.977 0 0 0 0 7.976c0 3.522 2.3 6.507 5.431 7.584.392.049.538-.196.538-.392v-1.37c-2.201.49-2.69-1.076-2.69-1.076-.343-.93-.881-1.175-.881-1.175-.734-.489.048-.489.048-.489.783.049 1.224.832 1.224.832.734 1.223 1.859.88 2.3.685.048-.538.293-.88.489-1.076-1.762-.196-3.621-.881-3.621-3.964 0-.88.293-1.566.832-2.153-.05-.147-.343-.978.098-2.055 0 0 .685-.196 2.201.832.636-.196 1.322-.245 2.007-.245s1.37.098 2.006.245c1.517-1.027 2.202-.832 2.202-.832.44 1.077.146 1.908.097 2.104a3.16 3.16 0 0 1 .832 2.153c0 3.083-1.86 3.719-3.62 3.915.293.244.538.733.538 1.467v2.202c0 .196.146.44.538.392A7.984 7.984 0 0 0 16 7.976C15.951 3.572 12.38 0 7.976 0z"></path></svg></a><a class="m-2" href="mailto:100.paperkite@gmail.com"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16" class="w-7 h-7" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M1 3.5l.5-.5h13l.5.5v9l-.5.5h-13l-.5-.5v-9zm1 1.035V12h12V4.536L8.31 8.9H7.7L2 4.535zM13.03 4H2.97L8 7.869 13.03 4z"></path></svg></a></div></div><span class="text-sm text-neutral-500">100paperkite<!-- --> © <!-- -->2023</span></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontMatter":{"title":"JVM(Java Virtual Machine)","description":null,"uploaded":"2023-01-08","updated":null,"tags":["java","jvm"],"draft":false},"slug":"how-jvm-works","mdxSource":{"compiledSource":"/*@jsxRuntime automatic @jsxImportSource react*/\nconst {Fragment: _Fragment, jsx: _jsx, jsxs: _jsxs} = arguments[0];\nconst {useMDXComponents: _provideComponents} = arguments[0];\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? _jsx(MDXLayout, Object.assign({}, props, {\n    children: _jsx(_createMdxContent, {})\n  })) : _createMdxContent();\n  function _createMdxContent() {\n    const _components = Object.assign({\n      h2: \"h2\",\n      p: \"p\",\n      ul: \"ul\",\n      li: \"li\",\n      h3: \"h3\",\n      h4: \"h4\",\n      ol: \"ol\",\n      code: \"code\",\n      strong: \"strong\",\n      a: \"a\"\n    }, _provideComponents(), props.components), {Image} = _components;\n    if (!Image) _missingMdxReference(\"Image\", true);\n    return _jsxs(_Fragment, {\n      children: [_jsx(_components.h2, {\n        children: \"가상 머신(Virtual Machine)\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"안에서 돌아가는 소프트웨어가 가상머신이 제공하는 환경과 자원에 제한을 받으며 가상 환경을 벗어날 수 없다.\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"System Virtual Machine\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"완전한 OS 실행을 지원.\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"같은 컴퓨터 내에서 여러 운영체제를 돌릴 수 있다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"Process Virtual Machine\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"단일 프로세스를 지원\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"플랫폼에 독립적인 실행환경과 추상화를 제공하여 하나의 프로그램을 실행한다.\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"JVM이 이런 경우다. (C#의 CLR도 마찬가지)\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"JVM?\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"JVM은 명세이다. 이 명세를 따른 구현체들이 따로 존재한다. (HotSpot VM 등등)\"\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"JVM Architecture\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"Java로 작성된 코드는 Compiler가 바이트 코드(.class 파일) 로 변환하고, JRE에 속한 JVM이 이 바이트 코드를 JIT 컴파일하여 실행된다.\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"JDK (Java Development Kit)\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"JRE를 포함하며, 개발을 위한 컴파일러나 디버거도 같이 제공된다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"JRE (Java Runtime Environment)\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"구성 요소\"\n      }), \"\\n\", _jsx(Image, {\n        src: \"/jvm-architecture.png\",\n        alt: \"jvm architecture\",\n        height: \"360px\",\n        sourceHref: \"https://www.freecodecamp.org\"\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Class Loader\"\n      }), \"\\n\", _jsx(Image, {\n        src: \"/jvm-class-loader.png\",\n        alt: \"jvm class loader\",\n        height: \"300px\",\n        sourceHref: \"https://www.freecodecamp.org\"\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Loading\"\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"1. 클래스 정보를 읽어온다.\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"‘.class’ 파일을 읽으면, 관련된 바이너리 데이터를 생성하고 이를 method area에 저장한다.\"\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"method area에 저장되는 정보들은 다음과 같다\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"패키지 명이 전부 포함된 클래스 경로(Fully Qualified Name), 해당 클래스의 부모 클래스\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"‘.class’파일이 Class인지, Interface인지 Enum인지 여부\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"접근 한정자(private, public …)와 메서드 정보 등\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"JVM이 클래스를 불러올 때 사용하는 3가지 로더는 다음과 같다.\"\n      }), \"\\n\", _jsxs(_components.ol, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"Bootstrap ClassLoader\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsxs(_components.li, {\n              children: [\"최상위 ClassLoader이다. 이 로더가 JAR파일이나\", _jsx(_components.code, {\n                children: \" $JAVA_HOME/jre/lib\"\n              }), \" 경로의 코어 라이브러리에서 패키지를 불러온다.\"]\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"Extension ClassLoader\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"Bootstrap 클래스 로더의 하위 클래스이고, Application ClassLoader의 상위 클래스이다.\"\n            }), \"\\n\", _jsxs(_components.li, {\n              children: [_jsx(_components.code, {\n                children: \"$JAVA_HOME/jre/lib/ext\"\n              }), \" 경로에서 패키지 파일을 불러온다.\"]\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"Application ClassLoader\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"이 클래스로더는 classpath의 파일들을 불러온다. (기본 경로값은 현재 어플리케이션 디렉토리)\"\n            }), \"\\n\", _jsxs(_components.li, {\n              children: [\"클래스를 못 찾으면 \", _jsx(_components.code, {\n                children: \"ClassNotFoundError\"\n              }), \"를 던진다.\"]\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"2. 정보를 읽어온 후엔 클래스 타입의 오브젝트를 생성한다.\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"JVM이 클래스를 처음 로딩해오면 JVM은 \", _jsx(_components.code, {\n            children: \"java.lang\"\n          }), \" 패키지에 정의된 \", _jsx(_components.code, {\n            children: \"Class\"\n          }), \" 클래스에서 오브젝트를 생성한다.\"]\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"이 클래스 오브젝트는 프로그래머가 클래스들의 정보(클래스명, 부모 클래스명, 메서드나 변수 정보 등)를 얻기 위해 사용할 수 있다.\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"클래스마다 하나의 오브젝트만 존재하도록 관리된다.\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"그리고 이 ‘Class’타입 오브젝트는 힙에 저장된다.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Linking\"\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"1. Verification\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\".class파일을 로딩해올 때, bytecode verifier라는 프로그램이 .class파일을 검증한다.\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"유효한 컴파일러로 컴파일 된 것인지.\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"올바른 구조, 포맷인지.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"verification중 하나라도 실패하면 JVM은 verifier exception 에러를 런타임에 던진다.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"2. Preparation\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"만약 클래스가 instance level이거나 static 변수를 가지고 있으면 기본값으로 초기화 시킨다. (설정해둔 초기값이 아님)\"\n        }), \"\\n\", _jsx(_components.li, {\n          children: \"ex. boolean → false, int → 0, 이런 식.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h4, {\n        children: \"3. Resolution\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"참조 변수들을 실제 메모리 주소값으로 변경한다.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Initialization\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"코드로 설정한 초기값들이 여기서 할당된다. 그리고 클래스의 정적 영역들이 실행된다.\"\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Memory Area (= Runtime Data Area)\"\n      }), \"\\n\", _jsx(Image, {\n        src: \"/jvm-runtime-data.png\",\n        alt: \"jvm runtime data\",\n        height: \"240px\",\n        sourceHref: \"https://www.freecodecamp.org\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.strong, {\n            children: \"Method Area\"\n          }), \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"모든 클래스 정보. (method data, constructor details …)\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"JVM마다 하나가 존재하며, 다른 스레드들과 공유되는 공간이다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.strong, {\n            children: \"Heap\"\n          }), \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"모든 오브젝트, static 변수(JAVA 8부터 적용)\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"JVM마다 하나가 존재하며, 다른 스레드들과 공유되는 공간이다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.strong, {\n            children: \"Stack\"\n          }), \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"함수 호출마다 쌓임. 로컬 변수들이 저장된다.\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"각 스레드마다 존재하며, 스레드가 종료되면 해당 영역도 제거된다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.strong, {\n            children: \"PC Register\"\n          }), \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"각 스레드마다 존재하며, 현재 실행중인 명령어 위치를 저장한다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [_jsx(_components.strong, {\n            children: \"Native Method Stack\"\n          }), \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"각 스레드마다 존재하며, native methods 정보를 저장한다.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"Execution Engine\"\n      }), \"\\n\", _jsx(Image, {\n        src: \"/jvm-execution-engine.png\",\n        alt: \"jvm execution engine\",\n        height: \"250px\",\n        sourceHref: \"https://www.freecodecamp.org\"\n      }), \"\\n\", _jsxs(_components.p, {\n        children: [_jsx(_components.code, {\n          children: \".class\"\n        }), \" 코드(bytecode)를 실행한다.\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"Interpreter\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"bytecode를 읽으면서 machine code로 변환한다.\"\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"JIT compiler\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"JVM은 처음엔 인터프리터를 쓰지만, 해석해야 할 bytecode가 반복적이면, JVM은 JIT를 대신 사용해서 전체 코드를 machine code로 컴파일한다. (매번 같은 코드에 대해 인터프리터를 사용하는 것 보다 한번에 컴파일해서 최적화 하는게 더 빠르기 때문)\"\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"JIT compiler는 다음과 같은 4가지로 이루어져 있다\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"Intermediate Code Generator - 중간 코드 생성\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"Code Optimizer - 코드 최적화\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"Target Code Generator - 머신 코드 생성\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"Profiler - 최적화를 위해 반복되는 코드를 찾음(hotspot)\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"GC(Garbage Collector)\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsx(_components.li, {\n          children: \"C 같은 언어들은 프로그래머가 직접 메모리를 할당/해제 해야 하지만 Java는 JVM이 알아서 처리해준다.\"\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"GC는 백그라운드로 실행되면서 주기적으로, 더 이상의 참조가 없는 Heap 상의 오브젝트들을 해제한다.\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"Mark → 메모리에서 더 이상 쓰지 않는 오브젝트들을 마킹.\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"Sweep → 마킹된 오브젝트들을 해제.\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"GC 방법엔 여러가지가 있다.\", \"\\n\", _jsxs(_components.ul, {\n            children: [\"\\n\", _jsx(_components.li, {\n              children: \"Serial GC → 싱글스레드 환경으로 돌아감. GC가 동작하면 어플리케이션이 멎어버림.\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"Parallel GC → 멀티 스레드를 이용. (하지만 여전히 어플리케이션이 멎을 때가 있음)\"\n            }), \"\\n\", _jsx(_components.li, {\n              children: \"G1GC\"\n            }), \"\\n\"]\n          }), \"\\n\"]\n        }), \"\\n\"]\n      }), \"\\n\", _jsx(_components.h3, {\n        children: \"JNI interface\"\n      }), \"\\n\", _jsx(_components.p, {\n        children: \"JVM에서 실행하는 자바 코드가 네이티브 응용 프로그램이나 다른 언어로 작성된 라이브러리를 호출/호출되는 것을 가능하게 하는 프레임워크. .dll 또는 .so 포맷.\"\n      }), \"\\n\", _jsx(_components.h2, {\n        children: \"참고\"\n      }), \"\\n\", _jsxs(_components.ul, {\n        children: [\"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: _jsx(_components.a, {\n              href: \"https://hasithas.medium.com/understanding-how-java-virtual-machine-jvm-works-a1b07c0c399a\",\n              children: \"https://hasithas.medium.com/understanding-how-java-virtual-machine-jvm-works-a1b07c0c399a\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\", _jsxs(_components.li, {\n          children: [\"\\n\", _jsx(_components.p, {\n            children: _jsx(_components.a, {\n              href: \"https://www.geeksforgeeks.org/jvm-works-jvm-architecture/\",\n              children: \"https://www.geeksforgeeks.org/jvm-works-jvm-architecture/\"\n            })\n          }), \"\\n\"]\n        }), \"\\n\"]\n      })]\n    });\n  }\n}\nreturn {\n  default: MDXContent\n};\nfunction _missingMdxReference(id, component) {\n  throw new Error(\"Expected \" + (component ? \"component\" : \"object\") + \" `\" + id + \"` to be defined: you likely forgot to import, pass, or provide it.\");\n}\n","frontmatter":{},"scope":{}}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"how-jvm-works"},"buildId":"uL8yKBX6xBidVOUOOPHk3","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>